primer_max_wt = 3000,
primer_tm = 60.0,
interactive = T
)
devtools::uninstall()
devtools::document()
devtools::install()
library(mutateR)
# Test 1d: Test1c, but nuclease = Cas9 and scoring method = deepspcas9
test1d <- run_mutateR(gene_id = 'TP53',
species = 'hsapiens',
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = 'Cas9',
score_method = 'deepspcas9',
design_primers = T,
primer_max_wt = 3000,
primer_tm = 60.0,
interactive = T
)
devtools::uninstall()
devtools::document()
devtools::install()
library(mutateR)
# Test 1d: Test1c, but nuclease = Cas9 and scoring method = deepspcas9
test1d <- run_mutateR(gene_id = 'TP53',
species = 'hsapiens',
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = 'Cas9',
score_method = 'deepspcas9',
design_primers = T,
primer_max_wt = 3000,
primer_tm = 60.0,
interactive = T
)
devtools::uninstall()
devtools::document()
devtools::install()
library(mutateR)
# Test 1d: Test1c, but nuclease = Cas9 and scoring method = deepspcas9
test1d <- run_mutateR(gene_id = 'TP53',
species = 'hsapiens',
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = 'Cas9',
score_method = 'deepspcas9',
design_primers = T,
primer_max_wt = 3000,
primer_tm = 60.0,
interactive = T
)
test1d$transcript_id
test1d$exons
mutateR_viewer(test1d$plot)
test1d$pairs
View(test1d$pairs)
?table
mutateR_viewer(test1d$plot)
mutateR_viewer(test1d$plot)
devtools::uninstall()
devtools::document()
devtools::install()
library(mutateR)
# Test 1d: Test1c, but nuclease = Cas9 and scoring method = deepspcas9
test1d <- run_mutateR(gene_id = 'TP53',
species = 'hsapiens',
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = 'Cas9',
score_method = 'deepspcas9',
design_primers = T,
primer_max_wt = 3000,
primer_tm = 60.0,
interactive = T
)
mutateR_viewer(test1d$plot)
mutateR_viewer(test1d$plot)
mutateR_viewer(test1d$plot)
devtools::uninstall()
devtools::document()
devtools::install()
library(mutateR)
# Test 1d: Test1c, but nuclease = Cas9 and scoring method = deepspcas9
test1d <- run_mutateR(gene_id = 'TP53',
species = 'hsapiens',
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = 'Cas9',
score_method = 'deepspcas9',
design_primers = T,
primer_max_wt = 3000,
primer_tm = 60.0,
interactive = T
)
mutateR_viewer(test1d$plot)
devtools::uninstall()
devtools::document()
devtools::install()
library(mutateR)
# Test 1d: Test1c, but nuclease = Cas9 and scoring method = deepspcas9
test1d <- run_mutateR(gene_id = 'TP53',
species = 'hsapiens',
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = 'Cas9',
score_method = 'deepspcas9',
design_primers = T,
primer_max_wt = 3000,
primer_tm = 60.0,
interactive = T
)
mutateR_viewer(test1d$plot)
devtools::uninstall()
devtools::document()
devtools::install()
library(mutateR)
# Test 1d: Test1c, but nuclease = Cas9 and scoring method = deepspcas9
test1d <- run_mutateR(gene_id = 'TP53',
species = 'hsapiens',
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = 'Cas9',
score_method = 'deepspcas9',
design_primers = T,
primer_max_wt = 3000,
primer_tm = 60.0,
interactive = T
)
mutateR_viewer(test1d$plot)
mutateR_viewer(test1d$plot)
?datatable
mutateR_viewer(test1d$plot)
devtools::uninstall()
devtools::document()
devtools::install()
library(mutateR)
# Test 1d: Test1c, but nuclease = Cas9 and scoring method = deepspcas9
test1d <- run_mutateR(gene_id = 'TP53',
species = 'hsapiens',
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = 'Cas9',
score_method = 'deepspcas9',
design_primers = T,
primer_max_wt = 3000,
primer_tm = 60.0,
interactive = T
)
mutateR_viewer(test1d$plot)
mutateR_viewer(test1d$plot)
activate_mutater_env()
check_mutater_env()
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(reticulate)
library(mutateR)
library(BSgenome.Hsapiens.UCSC.hg38)
tp53_res <- run_mutateR(
gene_id = "TP53",
species = "hsapiens",
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = "Cas9",
score_method = 'ruleset1',
design_primers = TRUE,
quiet = FALSE,
plot_mode = 'heat'
)
names(tp53_res)
kableExtra::scroll_box(knitr::kable(head(tp53_res$pairs,5)),width = '700px')
kableExtra::scroll_box(knitr::kable(head(tp53_res$pairs,5)),width = '700px')
library(BSgenome.Drerio.UCSC.danRer11)
opn4.1 <- run_mutateR(gene_id = 'opn4.1',
species = 'drerio',
genome = BSgenome.Drerio.UCSC.danRer11,
nuclease = 'Cas9',
score_method = 'ruleset1')
View(opn4.1$pairs)
tp53_recommended <- filter(tp53_res$pairs, tp53_res$pairs$recommended == TRUE)
kableExtra::scroll_box(knitr::kable(head(tp53_recommended,5)),width = '700px')
tp53_res$plot
head(tp53_res$pairs,0)
head(tp53_res$pairs,0)
View(tp53_res$pairs)
table(tp53_res$pairs$domains)
tp53_arc <- run_mutateR(
gene_id = "TP53",
species = "hsapiens",
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = "Cas9",
score_method = 'ruleset1',
top_n = NULL,
quiet = TRUE,
plot_mode = 'arc'
)
tp53_arc <- run_mutateR(
gene_id = "TP53",
species = "hsapiens",
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = "Cas9",
score_method = 'ruleset1',
design_primers = FALSE,
top_n = NULL,
quiet = TRUE,
plot_mode = 'arc'
)
tp53_arc$plot
library(reticulate)
library(mutateR)
library(BSgenome.Hsapiens.UCSC.hg38)
activate_mutater_env()
library(BSgenome.Drerio.UCSC.danRer11)
mbpa <- run_mutateR(gene_id = 'mbpa',species = 'drerio',genome = BSgenome.Drerio.UCSC.danRer11,nuclease = 'Cas9',score_method = 'deepspcas9',design_primers = T,interactive = T)
View(mbpa)
View(mbpa$pairs)
mbpa$plot
mutateR_viewer(mbpa$plot)
crisprScore::scoringMethodsInfo
# Test sequence (65-mer)
test_seq <- "AACGTGCTGACGATCGTAGCTAGCTGATCGATCGATCGATCGTAGCTAGCTGATCGATCGAT"
crisprScore::getLindelScores(test_seq)
# Test sequence (65-mer)
test_seq <- "AACGTGCTGACGATCGTAGCTAGCTGATCGATCGGGATCGATCGTAGCTAGCTGATCGATCGAT"
crisprScore::getLindelScores(test_seq)
# Test sequence (65-mer)
test_seq <- "TAACGTGCTGACGATCGTAGCTAGCTGATCGATCGGGATCGATCGTAGCTAGCTGATCGATCGAT"
crisprScore::getLindelScores(test_seq)
library(mutateR)
library(BSgenome.Drerio.UCSC.danRer11)
# Test 1c: Test1, but finding Cas12a gRNAs with DeepCpf1 scoring and primer design for recommended gRNA pairs
library(reticulate)
Hasan <- run_mutateR(gene_id = 'rps26',species = 'drerio',genome = BSgenome.Drerio.UCSC.danRer11,nuclease = 'Cas9',score_method = 'deepspcas9',interactive = T)
activate_mutater_env()
activate_mutater_env()
library(mutateR)
activate_mutater_env()
library(BSgenome.Drerio.UCSC.danRer11)
# Test 1c: Test1, but finding Cas12a gRNAs with DeepCpf1 scoring and primer design for recommended gRNA pairs
library(reticulate)
Hasan <- run_mutateR(gene_id = 'rps26',species = 'drerio',genome = BSgenome.Drerio.UCSC.danRer11,nuclease = 'Cas9',score_method = 'deepspcas9',interactive = T)
Hasan$plot
Hasan$scored_grnas
Hasan <- run_mutateR(gene_id = 'rps26',species = 'drerio',genome = BSgenome.Drerio.UCSC.danRer11,nuclease = 'Cas9',score_method = 'deepspcas9',min_score = 20, interactive = T)
Hasan$pairs
table(Hasan$scored_grnas$ontarget_score)
Hasan$scored_grnas
Hasan <- run_mutateR(gene_id = 'rps26',species = 'drerio',genome = BSgenome.Drerio.UCSC.danRer11,nuclease = 'Cas9',score_method = 'deepspcas9',min_score = 0, interactive = T)
Hasan <- run_mutateR(gene_id = 'rpe',species = 'drerio',genome = BSgenome.Drerio.UCSC.danRer11,nuclease = 'Cas9',score_method = 'deepspcas9', interactive = T)
View(Hasan$pairs)
View(Hasan$plot)
Hasan$plot
mutateR_viewer(Hasan$plot)
Hasan <- run_mutateR(gene_id = 'rpe',species = 'drerio',genome = BSgenome.Drerio.UCSC.danRer11,nuclease = 'Cas9',score_method = 'deepspcas9', interactive = F)
Hasan$plot
library(BSgenome.Hsapiens.UCSC.hg38)
foo <- run_mutateR(gene_id = 'FN1',
species = 'hsapiens',
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = 'Cas9',
score_method = 'deepspcas9',
design_primers = T,
primer_max_wt = 3000,
primer_tm = 60.0,
interactive = T
)
foo <- run_mutateR(gene_id = 'FN1',
species = 'hsapiens',
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = 'Cas9',
score_method = 'deepspcas9',min_score = 85,
design_primers = T,
primer_max_wt = 3000,
primer_tm = 60.0,
interactive = T
)
foo$plot
foo_static <- run_mutateR(gene_id = 'FN1',
species = 'hsapiens',
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = 'Cas9',
score_method = 'deepspcas9',min_score = 85,
design_primers = T,
primer_max_wt = 3000,
primer_tm = 60.0,
interactive = F
)
range(foo_static$pairs$ontarget_score_5p)
range(foo_static$pairs$ontarget_score_3p)
foo_static$plot
bar_static <- run_mutateR(gene_id = 'TTN',
species = 'hsapiens',
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = 'Cas9',
score_method = 'deepspcas9',min_score = 90,
design_primers = T,
primer_max_wt = 3000,
primer_tm = 60.0,
interactive = F
)
SRY <- run_mutateR(gene_id = 'SRY',
species = 'hsapiens',
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = 'Cas9',
score_method = 'deepspcas9',
design_primers = T,
primer_max_wt = 3000,
primer_tm = 60.0,
interactive = F
)
SRY$plot
SRY$pairs
View(SRY$pairs)
crisprScore::scoringMethodsInfo
crisprScore::getRuleSet3Scores()
?crisprScore::getRuleSet3Scores
if (interactive()){
flank5 <- "ACCG" #4bp
spacer <- "AATCGATGCTGATGCTAGAT" #20bp
pam    <- "AGG" #3bp
flank3 <- "AAT" #3bp
input  <- paste0(flank5, spacer, pam, flank3)
results <- getRuleSet3Scores(input)
}
if (interactive()){
flank5 <- "ACCG" #4bp
spacer <- "AATCGATGCTGATGCTAGAT" #20bp
pam    <- "AGG" #3bp
flank3 <- "AAT" #3bp
input  <- paste0(flank5, spacer, pam, flank3)
results <- crisprScore::getRuleSet3Scores(input)
}
library(crisprScore)
crisprScore::getRuleSet3Scores(input)
crisprScore::scoringMethodsInfo
devtools::uninstall()
devtools::document()
devtools::install()
devtools::uninstall()
devtools::document()
devtools::install()
devtools::install()
library(mutateR)
library(BSgenome.Hsapiens.UCSC.hg38)
library(BSgenome.Drerio.UCSC.danRer11)
# Test 1c: Test1, but finding Cas12a gRNAs with DeepCpf1 scoring and primer design for recommended gRNA pairs
library(reticulate)
install_mutater_env(fresh = T)
library(mutateR)
library(BSgenome.Hsapiens.UCSC.hg38)
library(BSgenome.Drerio.UCSC.danRer11)
# Test 1c: Test1, but finding Cas12a gRNAs with DeepCpf1 scoring and primer design for recommended gRNA pairs
library(reticulate)
activate_mutater_env()
reticulate::py_module_available("rs3")
validate_rs3()
devtools::uninstall()
devtools::install()
library(mutateR)
validate_rs3()
# Test sequences from rs3 documentation
test_seqs <- c(
"GACGAAAGCGACAACGCGTTCATCCGGGCA",
"AGAAAACACTAGCATCCCCACCCGCGGACT"
)
# Test with Hsu2013 (as shown in their example)
scores_hsu <- predict_rs3_python(test_seqs, tracr_variant = "Hsu2013")
# Test sequences from rs3 documentation
test_seqs <- c(
"GACGAAAGCGACAACGCGTTCATCCGGGCA",
"AGAAAACACTAGCATCCCCACCCGCGGACT"
)
# Test with Hsu2013 (as shown in their example)
scores_hsu <- predict_rs3_seq(test_seqs, tracr_variant = "Hsu2013")
# Test sequences from rs3 documentation
test_seqs <- c(
"GACGAAAGCGACAACGCGTTCATCCGGGCA",
"AGAAAACACTAGCATCCCCACCCGCGGACT"
)
# Test with Hsu2013 (as shown in their example)
scores_hsu <- reticulate::py$predict_rs3_seq(test_seqs, tracr_variant = "Hsu2013")
# Test sequences from rs3 documentation
test_seqs <- c(
"GACGAAAGCGACAACGCGTTCATCCGGGCA",
"AGAAAACACTAGCATCCCCACCCGCGGACT"
)
# Test with Hsu2013 (as shown in their example)
scores_hsu <- reticulate::py$predict_rs3_seq(test_seqs, tracr_variant = "Hsu2013", n_jobs = 1)
print(scores_hsu)
# Expected from documentation:
# [-0.90030944, 1.11451622]
devtools::uninstall()
devtools::document()
devtools::install()
library(mutateR)
library(BSgenome.Hsapiens.UCSC.hg38)
# 3A. Get exons for a test gene
tx_info <- get_gene_info("TP53", "hsapiens")
exons_gr <- get_exon_structures(tx_info$canonical$ensembl_transcript_id[1],
"hsapiens",
output = "GRanges")
# 3B. Find Cas9 sites
cas9_sites <- find_cas9_sites(exons_gr, BSgenome.Hsapiens.UCSC.hg38)
length(cas9_sites)
# Expected: >0 sites
# 3C. Score with RS3
scored_rs3 <- score_grnas(cas9_sites, method = "ruleset3", tracr = "Chen2013")
# Check output
head(mcols(scored_rs3)[, c("protospacer_sequence", "ontarget_score", "scoring_method")])
# Expected: scoring_method = "ruleset3", numeric ontarget_scores
# 3D. Confirm scores are numeric and within reasonable range
summary(scored_rs3$ontarget_score)
sum(is.na(scored_rs3$ontarget_score))
# Expected: Minimal/no NAs, scores in reasonable range
# 4A. RS3 pipeline run
tp53_rs3 <- run_mutateR(
gene_id = "TP53",
species = "hsapiens",
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = "Cas9",
score_method = "ruleset3",
tracr = "Chen2013",
design_primers = FALSE,
quiet = FALSE,
plot_mode = "heat"
)
devtools::uninstall()
devtools::document()
devtools::install()
library(mutateR)
# 4A. RS3 pipeline run
tp53_rs3 <- run_mutateR(
gene_id = "TP53",
species = "hsapiens",
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = "Cas9",
score_method = "ruleset3",
tracr = "Chen2013",
design_primers = FALSE,
quiet = FALSE,
plot_mode = "heat"
)
# 4B. Check output structure
names(tp53_rs3)
nrow(tp53_rs3$pairs)
head(tp53_rs3$pairs[, c("protospacer_sequence_5p", "ontarget_score_5p",
"protospacer_sequence_3p", "ontarget_score_3p", "recommended")])
View(tp53_rs3$pairs)
devtools::uninstall()
devtools::document()
devtools::install()
library(mutateR)
# 4A. RS3 pipeline run
tp53_rs3 <- run_mutateR(
gene_id = "TP53",
species = "hsapiens",
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = "Cas9",
score_method = "ruleset3",
tracr = "Chen2013",
design_primers = FALSE,
quiet = FALSE,
plot_mode = "heat"
)
# 4B. Check output structure
names(tp53_rs3)
nrow(tp53_rs3$pairs)
head(tp53_rs3$pairs[, c("protospacer_sequence_5p", "ontarget_score_5p",
"protospacer_sequence_3p", "ontarget_score_3p", "recommended")])
test1 <- run_mutateR(gene_id = 'TP53',
species = 'hsapiens',
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = 'Cas9',
score_method = 'ruleset1')
View(tp53_rs3$pairs)
test1c <- run_mutateR(gene_id = 'TP53',
species = 'hsapiens',
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = 'Cas12a',
score_method = 'deepcpf1',
design_primers = T,
primer_max_wt = 3000,
primer_tm = 60.0,
interactive = T
)
# 4A. RS3 pipeline run
tp53_rs3 <- run_mutateR(
gene_id = "TP53",
species = "hsapiens",
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = "Cas9",
score_method = "ruleset3",
tracr = "Chen2013",
design_primers = TRUE,
quiet = FALSE,
plot_mode = "heat"
)
# 4B. Check output structure
names(tp53_rs3)
nrow(tp53_rs3$pairs)
head(tp53_rs3$pairs[, c("protospacer_sequence_5p", "ontarget_score_5p",
"protospacer_sequence_3p", "ontarget_score_3p", "recommended")])
mutateR_viewer(tp53_rs3)
# 4A. RS3 pipeline run
tp53_rs3 <- run_mutateR(
gene_id = "TP53",
species = "hsapiens",
genome = BSgenome.Hsapiens.UCSC.hg38,
nuclease = "Cas9",
score_method = "ruleset3",
tracr = "Chen2013",
design_primers = TRUE,
quiet = FALSE,
plot_mode = "heat",
interactive = TRUE
)
mutateR_viewer(tp53_rs3)
tp53_rs3$plot
mutateR_viewer(tp53_rs3$plot)
